--- source/perturbations.c
+++ source/perturbations.c
@@ -1024,6 +1024,25 @@
    /* STANDARD GR TERM */
    delta_rho = (rho_plus_p * theta + (rho + p) * sigma) / k2;
 
+  /* ----------------------------------------------------------------- */
+  /* START MODIFICATION: Non-Local Gravitational Leakage (Ibrahim Gul) */
+  /* Implementing spectral propagator mu(k) = 1 + (k_c/k)^(2-n)        */
+  /* ----------------------------------------------------------------- */
+  
+  double k_c_val = 0.14;   // Leakage scale in h/Mpc
+  double n_val = 1.462;    // Transition index
+  double mu_k = 1.0;
+
+  if (k > 1.e-5) {
+      mu_k = 1.0 + pow(k_c_val / k, 2.0 - n_val);
+  }
+  
+  delta_rho *= mu_k;
+  
+  /* ----------------------------------------------------------------- */
+  /* END MODIFICATION                                                  */
+  /* ----------------------------------------------------------------- */
+
    /* Einstein Equations */
    if (pba->has_ad_matter == _TRUE_) {
